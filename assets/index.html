<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1/jquery.min.js"></script>

    <title>Simple SSE-Chat</title>
  </head>
  <body>
    <h1>SSE Chat Simple Example</h1>
    <form action="/push_message" method="get">
      <label for="login">Login:</label>
      <input type="text" name="login" id="login" value="" />
      <label for="message">Message:</label>
      <input type="text" name="message" id="message" value="" />
      <input type='submit' value="GO!" />
    </form>
    <div id='chat'>
    </div>
    <script>
      // reading
      var es = new EventSource('/stream');
      es.onmessage = function(e) { $('#chat').append(e.data + "<br>") };

      // writing
      $("form").on('submit',function(e) {
        $.get('/push_message', {
          login: $('#login').val(),
          message: $('#message').val()
        });
        $('#message').val('');
        $('#message').focus();
        e.preventDefault();
      });
    </script>
  </body>
</html>
